<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords"
        content="vivo智能手机官方商城, vivo手机, 智能手机, vivo商城, vivo5G手机, vivo官网, VIVO, iQOO3, X30 pro, NEX3, Z6, S6, 真无线蓝牙耳机">
    <meta name="description"
        content="vivo官网商城-提供vivo最新款智能手机、配件在线订购，包括vivo手机系列NEX 3S、vivo X30 Pro,iQOO系列iQOO 3等,同时提供以旧换新、手机镭雕定制服务及售前售后支持.">
    <title>vivo智能手机官方商城</title>
    <link rel="stylesheet" href="../dist/css/main.min.css">
    <link rel="stylesheet" href="../iconfont/iconfont.css">
</head>

<body>
    <!-- //头部版心1230px 内容版心1200px -->
    <!-- header区域start -->
    <header>
        <div class="header-top">
            <div class="header-con clearFixed">
                <ul class="fl header-top-left">
                    <li><a href="https://www.vivo.com.cn/brand/home">品牌</a></li>
                    <li><a href="https://www.vivo.com.cn/funtouchos">Funtouch OS</a></li>
                    <li><a href="https://www.vivo.com.cn/store">体验店</a></li>
                    <li><a href="https://www.vivo.com.cn/cooperation">企业业务</a></li>
                    <li><a href="https://bbs.vivo.com.cn/">社区</a></li>
                </ul>
                <ul class="fr head-top-right">
                    <li><a href="https://shopact.vivo.com.cn/topic/TP3rtu47l089g0/index.html"><i
                                class="iconfont"></i>下载APP</a></li>
                    <li><a href="">购物车</a></li>
                    <li><a href="./html/login.html" id="loginBn">登录</a></li>
                    <li><a href="./html/register.html" id="registerBn">注册</a></li>
                </ul>
            </div>
        </div>
        <div class="header-bto">
            <div class="main clearFixed">
                <a class="header-bto-logo fl">
                    <i class="iconfont icon-vivo"></i>
                </a>
                <ul class="header-bto-list clearFixed fl">
                    <li><a href="">NEX系列</a>
                        <div></div>
                    </li>
                    <li><a href="">X系列</a>
                        <div></div>
                    </li>
                    <li><a href="">S系列</a>
                        <div></div>
                    </li>
                    <li><a href="">Y系列</a>
                        <div></div>
                    </li>
                    <li><a href="">Z系列</a>
                        <div></div>
                    </li>
                    <li><a href="">U系列</a>
                        <div></div>
                    </li>
                    <li><a href="">IQOO系列</a>
                        <div></div>
                    </li>
                    <li><a href="">智能硬件</a>
                        <div></div>
                    </li>
                    <li><a href="" class="default">商城</a></li>
                    <li><a href="">服务</a></li>
                </ul>
                <div class="header-bto-search fr">
                    <span class="">
                        <i class="iconfont icon-sousuo"></i>
                    </span>
                </div>
            </div>
        </div>

    </header>
    <!-- header区域end -->
    <div class="shooppingCart">
        <div class="shop main">
            <div class="shopping">
                <span>我的购物车</span>
                <a href="../index.html" target="_blank">继续购物 ></a>
            </div>
            <div>

            </div>
            <div class="shopOrder">

            </div>
            <div>
                <div class="total clearFixed">
                    <ul class="clearFixed">
                        <li><input type="checkbox" id="allChecked">全选</li>
                        <li><a href="javascript:void(0);">删除选中的商品</a></li>
                        <li><a href="javascript:void(0);">移入收藏夹</a></li>
                    </ul>
                    <div class="all fr clearFixed">
                        <button class="fr" type="button" disabled>去结算</button>
                        <div class="fr">
                            <p><!-- 已选商品 <b id="total">0</b> 件， -->合计（不含运费）：<span id="allPrice">
                                    <!-- ¥0.00 --></span></p>
                            <p> ( 商品总价：<span id="all">¥0.00</span> 优惠： <span>¥0.00</span>)</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="cont5">
                <div class="saleArea clearFixed">
                    <span class="like">猜你喜欢</span>
                </div>
                <ul class="cont2List cont6List clearFixed">
                    <!-- <li>
                        <p>
                            <a href="">
                                <img src="./images/v3.png" alt="">
                                <img src="./images/cv3.png" alt="">
                            </a>
                        </p>
                        <p>vivo X27 8GB+256GB 雀羽蓝</p>
                        <p>限时享3期免息</p>
                        <p><span><i>¥</i>2498</span></p>
                        <button id="cartBtn" class="cartBtn" type="button">加入购物车</button>
                    </li> -->
                </ul>
            </div>
        </div>
    </div>

    <!-- footer区域start -->
    <footer>
        <div class="foot main">
            <div class="foot-top">
                <ul>
                    <li><i class="iconfont icon-guanfangzhengpinbaozheng"></i>官方正品</li>
                    <li><i class="iconfont icon-shunfengbaoyou"></i>顺丰极速达</li>
                    <li><i class="iconfont icon-xin"></i>全国联保</li>
                    <li><i class="iconfont icon-jisuda"></i>镭雕定制</li>
                </ul>
            </div>
            <div class="foot-mid clearFixed">
                <ul class="list-one">
                    <li>热门链接</li>
                    <li><a href="">NEX3</a></li>
                    <li><a href="">IQOO Pro</a></li>
                    <li><a href="">Z5</a></li>
                    <li><a href="">vivo摄影</a></li>
                    <li><a href="">查找手机</a></li>
                    <li><a href="">常见问题</a></li>
                </ul>
                <ul class="list-one">
                    <li>在线购买</li>
                    <li><a href="">官方商城</a></li>
                    <li><a href="">选购手机</a></li>
                    <li><a href="">选购配件</a></li>
                    <li><a href="">政企服务</a></li>
                    <li><a href="">以旧换新</a></li>
                    <li><a href="">保障服务</a></li>
                </ul>
                <ul class="list-one">
                    <li>服务支持</li>
                    <li><a href="">服务首页</a></li>
                    <li><a href="">服务网点查询</a></li>
                    <li><a href="">真伪查询</a></li>
                    <li><a href="">预约维修</a></li>
                    <li><a href="">维修配件价格</a></li>
                    <li><a href="">服务政策</a></li>
                    <li><a href="">安全公告</a></li>
                </ul>
                <ul class="list-one">
                    <li>vivo社区</li>
                    <li><a href="">社区首页</a></li>
                    <li><a href="">摄影专区</a></li>
                    <li><a href="">微博</a></li>
                    <li><a href="">贴吧</a></li>
                    <li><a href="">兴趣部落</a></li>
                </ul>
                <ul class="list-one">
                    <li>关于vivo</li>
                    <li><a href="">vivo简介</a></li>
                    <li><a href="">工作机会</a></li>
                    <li><a href="">新闻资讯</a></li>
                    <li><a href="">采购平台</a></li>
                    <li><a href="">供应商协同平台</a></li>
                    <li><a href="">开放平台</a></li>
                </ul>
                <ul class="list-one">
                    <li class="online"><i class="server iconfont icon-kefu"></i>在线客服</li>
                    <li class="tel">400-678-9688</li>
                    <li class="time">全国客户服务热线 7*24小时</li>
                    <li class="tel">400-678-9688</li>
                    <li class="time">NEX 专属服务热线 7*24小时</li>
                    <li class="vivo">关注vivo</li>
                    <li>
                        <i class="server iconfont icon-iconfontweibo"></i>
                        <i class="server iconfont icon-weixin1"><span class="hide"><img src="../images/zhifubao.png"
                                    alt="">
                                <p>公众号：vivo官方商城</p><b></b>
                            </span></i>
                        <i class="server iconfont icon-zhifubao"><span class="hide"><img src="../images/zhifubao.png"
                                    alt="">
                                <p>生活号：vivo智能手机</p><b></b>
                            </span></i>
                        <i class="server iconfont icon-lianjie"><span class="hide"><img src="../images/smallProgram.jpg"
                                    alt="">
                                <p>小程序：vivo官方商城</p><b></b>
                            </span></i>
                    </li>
                </ul>
            </div>
            <div class="foot-bto clearFixed">
                <span>Copyright &copy;2011-2020 广东天宸网络科技有限公司 版权所有 保留一切权利</span>
                <ul class="link clearFixed">
                    <li><a href="https://www.vivo.com.cn/about-vivo/privacy-policy">隐私政策</a></li>
                    <li><a href="https://www.vivo.com.cn/about-vivo/legal">法律声明</a></li>
                    <li><a
                            href="https://wwwstatic.vivo.com.cn/vivoportal/files/resource/files/1587091106279/fdcf3558-9961-4702-9992-f6eef73c40e1.png">营业执照</a>
                    </li>
                    <li><a href="http://www.beian.miit.gov.cn/" target="_blank">粤B2-20080267</a></li>
                    <li><a href="http://www.beian.miit.gov.cn/" target="_blank">粤ICP备14052990号</a></li>
                    <li><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44190002004246"
                            target="_blank">粤公网安备 44190002004246号</a></li>
                </ul>
                <p class="sp">
                    <a href="https://www.vivo.com.cn/intPortal/index"><i class="location iconfont icon-diqiu"></i>Select
                        Location</a>
                </p>
            </div>

        </div>

    </footer>
    <!-- footer区域end -->
</body>
<script type="module">
    import Utils from "../js/Utils.js";
    import CheckBox from "../js/CheckBox.js";
    import Shopping from "../js/Shopping.js";
   
    var item_id = location.search.split("?")[1];
   
    ajax({id:item_id});
    
    function ajax(data) {
        var xhr = new XMLHttpRequest();
        xhr.addEventListener("load", loadhandler);
        xhr.open("POST", "http://192.168.43.28:4006/savegoodslist");
        xhr.send(JSON.stringify(data));
    }
    var arr;
  
    function loadhandler(e) {
    }
    arr = ajaxRequest("shoppinglist");
    var shopping = new Shopping();
    shopping.addEventListener(Shopping.CHECK_CHANGE, checkChangeHandler);
    shopping.addEventListener(Shopping.STEP_CHANGE, stepChangeHandler);
    shopping.addEventListener(Shopping.DELETE_CHANGE, deleteChangeHandler);
    shopping.setData(arr["list"])
    shopping.appendTo(".shopOrder");
   
   var checkList=[];
   var final = [];
   var allChecked = document.querySelector("#allChecked");
   allChecked.addEventListener("click",clickHandler);


    function totalPrice(arr) {
        // var total = document.querySelector("#total");
        // total.textContent = arr.length;
        var all = document.querySelector("#all");
        var allPrice = document.querySelector("#allPrice");
        var price = arr.reduce((value, item) => {
            if(item.checked)
            value += Number(item.total);
            return value;
        }, 0)
        allPrice.textContent = price;
        all.textContent = price;
    }
    function checkChangeHandler(e) {
        e.data["checked"]=!e.data["checked"];
        checkList.push(e.data);
        final = Array.from(new Set(checkList));
        allSelect(final);
        totalPrice(final);
    }
    function stepChangeHandler(e) {
        final.forEach(item=>{
            if(e.data.id==item.id) {
                item.num=e.step;
                item.total=e.step*item.price;
            }
        });
        totalPrice(final);
    }

    function deleteChangeHandler(e) {
        final=final.filter(item=>{
            return item.id!==e.data.id;
        });
        totalPrice(final);
        e.currentTarget.elem.children[1].children[1].remove();
    }
    function allSelect(final) {
        allChecked.checked = final.every(item => {
            return item.checked
        });
    }

    function clickHandler(e){
        final.forEach(item=>{
               item.checked=e.currentTarget.checked;
           });
        totalPrice(final);
    }
    function ajaxRequest(url,e){
        var arr;
        var xhr = new XMLHttpRequest();
        xhr.addEventListener("readystatechange",readyHandler);
        xhr.open("POST","http://192.168.43.28:4006/"+url,false);
        if(!e) {
            xhr.send(JSON.stringify());
        }else{
            xhr.send(JSON.stringify([e.data.id]));
        }
        function readyHandler(e){
            console.log(e.currentTarget.response);
            arr = JSON.parse(e.currentTarget.response);
        }
        return arr;
    }
   
</script>

</html>